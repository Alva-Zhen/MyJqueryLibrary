<!DOCTYPE html>
<html lang="zh-CH">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>一键处理待办</title>
    <link rel="stylesheet" href="./css/userManagement.css">
</head>

<body>
    <div class="box">
        <div class="box-con">
            <div class="box-header">
                <p>
                    <span>审批管理</span>
                    <span>
                        <span class="all-counts"></span> Product</span>
                </p>
                <div class="linkage-btn">
                    <button class="active">产品</button>
                    <button>结算单</button>
                </div>
            </div>
            <div class="options-system">
                <img src="./img/Icon-add.png" type="0" class="options-add" alt="" title="新增" />
                <img class="options-add" type="1" src=" ./img/combination.png" alt="" title="用户组管理" />
                <img src="./img/Icon-delet.png" class="options-delete" alt="" title="删除" />
            </div>
            <div id="table" class="overflow-y-table"></div>
        </div>
        <div class="page">
            <div class="page-turn pre" type="pre"></div>
            <p>Page
                <span class="page-current">2</span>
                of
                <span class="page-all">3</span>
                <select id="page-select">
                    <option selected="selected" value="10">每页显示：10条</option>
                    <option value="9">每页显示：9条</option>
                    <option value="8">每页显示：8条</option>
                    <option value="7">每页显示：7条</option>
                </select>
            </p>
            <div class="page-turn next" type="next"></div>
        </div>
    </div>


    <script src="./js/jquery.selectMulti.js"></script>

    <script>
        $(function () {

            //分页
            page(function (data) {
                creatTable(data)
            })


            //表格
            creatTable();
            /* 删除角色 */
            $('.options-delete').click(function () {
                var ids = new Array();
                var flag = new Array();
                var trSelected = $('#table tbody').find('input:checked');
                if (trSelected.length == 0) {
                    showTip('请选择要删除的角色，可多选！');
                } else {
                    for (var i = 0; i < trSelected.length; i++) {
                        ids.push($(trSelected[i]).parents('tr').attr('userId'));
                        flag.push($(trSelected[i]).parents('tr').find('.deleteFlag').text());
                    }
                    var deleteFlag = $.inArray('0', flag);
                    if (deleteFlag == "-1") {
                        $('.confirm-opration').attr('ids', ids);
                        $('.confirm-opration').attr('zero', 'delete');
                        showOpration('确认删除吗？')
                    } else {
                        showTip('已删除的不能再次选择！！！')
                    }
                }
            });


        });
        function creatTable(data) {
            var ajaxData = data ? data : {}

            ajaxAPI('../product/review/list', ajaxData, function (res) {
                var data = res.data.result;
                $('.page span:nth-child(1)').text(res.data.pageNo);
                $('.page span:nth-child(2)').text(res.data.totalPages);
                $('.all-counts').text(res.data.totalCount)
                table({
                    id: '#table',
                    thead: ['订单号', '结算单号', '客户编码', '产品代码', '套餐编码', '地区代码', '客户名称', '客户地址'],
                    tbody: function () {
                        var tds = '';
                        var list = [];
                        for (var i = 0; i < data.length; i++) {
                            tds +=
                                '<tr userId="' + data[i].userId + '" defRoleId="' + data[i].defRoleId + '">' +
                                '<td>' + data[i].userName + (data[i].deleteFlag == "1" ? '' : '  (已删除)  ') + '</td>' +
                                '<td>' + data[i].loginName + '</td>' +
                                '<td>' + data[i].userCode + '</td>' +
                                '<td>' + data[i].regionCode + '</td>' +
                                '<td>' + (data[i].regionName == null ? "" : data[i].regionName) + '</td>' +
                                '<td>' +
                                '<p>' + data[i].regionCode + '</p>' +
                                '<p>' + data[i].regionName + '</p>' +
                                '</td>' +
                                '<td>' + (data[i].phoneNumber == null ? "" : data[i].phoneNumber) + '</td>' +
                                '<td>' + (data[i].email == null ? "" : data[i].email) + '</td>' +
                                '</tr>'
                        }
                        return tds;
                    }
                });

            })
        };
    </script>
</body>

</html>